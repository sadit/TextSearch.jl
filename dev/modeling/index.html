<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Models ¬∑ TextSearch.jl</title><link rel="canonical" href="https://sadit.github.io/TextSearch.jl/modeling/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">TextSearch.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../searching/">Searching</a></li><li><a class="tocitem" href="../preprocessing/">Preprocessing</a></li><li class="is-active"><a class="tocitem" href>Models</a><ul class="internal"><li><a class="tocitem" href="#Entropy-models"><span>Entropy models</span></a></li><li class="toplevel"><a class="tocitem" href="#Inspecting-models"><span>Inspecting models</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sadit/TextSearch.jl/blob/master/docs/src/modeling.md#L" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Modeling-the-text-collection"><a class="docs-heading-anchor" href="#Modeling-the-text-collection">Modeling the text collection</a><a id="Modeling-the-text-collection-1"></a><a class="docs-heading-anchor-permalink" href="#Modeling-the-text-collection" title="Permalink"></a></h1><p>The processesing and tokenization is defined through a text configuration <a href="../api/#TextSearch.TextConfig"><code>TextConfig</code></a>.</p><p>Once a <code>Tokenizer</code> is defined, we need to create a model for the text, we select a typical vector model. The model constructor needs to know the weighthing scheme and some stats about the corpus&#39; vocabulary:</p><pre><code class="language-julia-repl">julia&gt; model = VectorModel(IdfWeighting(), TfWeighting(), compute_bow_corpus(tok, corpus))
{VectorModel global_weighting=IdfWeighting(), local_weighting=TfWeighting(), train-voc=44550, train-n=50000, maxfreq=94018}</code></pre><p>Now we can vectorize a text</p><pre><code class="language-julia-repl">julia&gt; vectorize(model, tok, &quot;la mejor m√∫sica, la m√∫sica de siempre!&quot;; normalize=false)
ERROR: MethodError: no method matching vectorize(::VectorModel{IdfWeighting, TfWeighting}, ::Tokenizer, ::String; normalize=false)
Closest candidates are:
  vectorize(::VectorModel{_G, _L}, !Matched::Dict{UInt64, Int32}; normalize) where {_L, _G} at /home/runner/work/TextSearch.jl/TextSearch.jl/src/vmodel.jl:195
  vectorize(!Matched::Tokenizer, !Matched::VectorModel, ::Any; bow, normalize) at /home/runner/work/TextSearch.jl/TextSearch.jl/src/vmodel.jl:225</code></pre><p>Note: by default <code>normalize=true</code> normalizes the vector.</p><h2 id="Entropy-models"><a class="docs-heading-anchor" href="#Entropy-models">Entropy models</a><a id="Entropy-models-1"></a><a class="docs-heading-anchor-permalink" href="#Entropy-models" title="Permalink"></a></h2><p><code>TextSearch</code> supports a family of text models based on labeled data called Entropy-based models; which use the empirical distribution of symbols along labels to determine its importance; the entropy of this distribution is used to compose the symbol weight. In this example, the variable <code>labels</code> is a categorical array containing emojis associated to each text in the corpus, see <a href="https://github.com/JuliaData/CategoricalArrays.jl"><code>CategoricalArrays.jl</code></a>.</p><pre><code class="language-julia-repl">julia&gt; labels
50000-element CategoricalArrays.CategoricalArray{String,1,UInt32}:
 &quot;üò∞&quot;
 &quot;üò•&quot;
 &quot;üòä&quot;
 &quot;üòè&quot;
 &quot;‚ô°&quot;
 &quot;üíî&quot;
 &quot;üôÇ&quot;
 &quot;üòã&quot;
 &quot;üòä&quot;
 &quot;üòå&quot;
 ‚ãÆ
 &quot;üòú&quot;
 &quot;üòÖ&quot;
 &quot;üëè&quot;
 &quot;üò¥&quot;
 &quot;üò†&quot;
 &quot;ü§î&quot;
 &quot;üíî&quot;
 &quot;ü§î&quot;
 &quot;üò¨&quot;

julia&gt; vcorpus = compute_bow_corpus(tok, corpus)
50000-element Vector{Dict{UInt64, Int32}}:
 Dict(0x9531daea6936b073 =&gt; 1, 0xd2f9809da9e697e9 =&gt; 1, 0x329a86240525eb48 =&gt; 1, 0x479860b54cec66b8 =&gt; 1, 0xa36b61cbc03e4f9a =&gt; 1, 0x44460958690ba8ff =&gt; 1, 0x3a0b81da78641d39 =&gt; 1, 0xa3205815fa30f6e1 =&gt; 1, 0x8ab42af509b7b0a0 =&gt; 1, 0xfb3c6d9b3b2e8b45 =&gt; 1‚Ä¶)
 Dict(0x9531daea6936b073 =&gt; 1, 0xf8ab34f91df3b7a2 =&gt; 1, 0x054d3f6b36e26ecb =&gt; 1, 0x445bddce39833538 =&gt; 1, 0xc05192268f090e63 =&gt; 1, 0xf24212015864febb =&gt; 2, 0x28b5436e1c8687ba =&gt; 1, 0x10a87038574b5cef =&gt; 1, 0x2bbcce7fa0db5f79 =&gt; 1, 0x92b02cd72f7668e4 =&gt; 1‚Ä¶)
 Dict(0x9531daea6936b073 =&gt; 1, 0x054d3f6b36e26ecb =&gt; 1, 0xd5b424159d628f4b =&gt; 1, 0x2fe6a7fecfb24ad9 =&gt; 1, 0x401e00291c65e013 =&gt; 1, 0x70e4da886f57cdc1 =&gt; 1, 0x10a87038574b5cef =&gt; 1, 0xf6242fcf0690956f =&gt; 1, 0xb51a946fc039d9e1 =&gt; 1, 0x53b20e3050918288 =&gt; 1‚Ä¶)
 Dict(0x20d2528a955ff31d =&gt; 1, 0x9531daea6936b073 =&gt; 1, 0x8c9a7eb2a0787972 =&gt; 1, 0xb545974aff4f5b3e =&gt; 1, 0xef7d41ff03fb456f =&gt; 1, 0x1a7869342e66f0af =&gt; 1, 0x10a87038574b5cef =&gt; 1, 0xf79fb45149d8bd35 =&gt; 1, 0x9421c95b9f94b2ab =&gt; 1, 0xa8229cd8ce53f152 =&gt; 1‚Ä¶)
 Dict(0x9531daea6936b073 =&gt; 1, 0xff99fd37e0ef0476 =&gt; 1, 0x457578ce99ca2ca7 =&gt; 1, 0xf118488b48c6edc4 =&gt; 1, 0x479860b54cec66b8 =&gt; 1, 0xdfa4bb8492a59c98 =&gt; 1)
 Dict(0x9531daea6936b073 =&gt; 1, 0xf24212015864febb =&gt; 1, 0x782f0458bb3033eb =&gt; 1, 0x10a87038574b5cef =&gt; 1, 0x59a979f4300a6ce7 =&gt; 1, 0x3bdbf6858e455a91 =&gt; 1, 0x53136bf4e21af201 =&gt; 1, 0x7c79f6451b0ec17a =&gt; 1, 0x5250b8b5f2ac2b4b =&gt; 1, 0x4d45112e43473c4f =&gt; 1‚Ä¶)
 Dict(0x916dc4b1a396e88b =&gt; 1, 0x9531daea6936b073 =&gt; 1, 0x73eb6390c84ee754 =&gt; 1, 0xd28c5f830f6806f5 =&gt; 1, 0x0e9bed5944748b2f =&gt; 1, 0x52eb59ce5bf9b65d =&gt; 1, 0xf577e1a2216bf83b =&gt; 1, 0xc05192268f090e63 =&gt; 1, 0x8329420c20ba301f =&gt; 1, 0x81c92ba10d384d05 =&gt; 1‚Ä¶)
 Dict(0x9531daea6936b073 =&gt; 3, 0x8eae84012c8f8ba6 =&gt; 1, 0x3682426b08290180 =&gt; 1, 0xe634b06dbe598108 =&gt; 1, 0x6d1abd76544ec6f4 =&gt; 1, 0x5468884517a401f2 =&gt; 1, 0x405c5afdcb4767d0 =&gt; 1, 0xc9490cc9a800438b =&gt; 1)
 Dict(0x9531daea6936b073 =&gt; 1, 0x02eb319735bca9ef =&gt; 1, 0x7b5456e520a5ad86 =&gt; 1, 0x93017f16f1845e03 =&gt; 1, 0x2b031860c1d1d9e7 =&gt; 1, 0x6100ecf805118bdb =&gt; 1, 0x271cd207240ad175 =&gt; 2, 0x2bbcce7fa0db5f79 =&gt; 1, 0xfa232f94411b00cd =&gt; 2, 0x93c231f301267410 =&gt; 1‚Ä¶)
 Dict(0x2fa1b48a730999dc =&gt; 1, 0x9531daea6936b073 =&gt; 1, 0xcbfff74505a70272 =&gt; 1, 0xd3169c965c7173de =&gt; 1, 0x7ba5684185bfa9ab =&gt; 1, 0xe4636df2fb8c78dc =&gt; 1, 0x7c79f6451b0ec17a =&gt; 1, 0x4d45112e43473c4f =&gt; 1, 0x3500d4bb83e2660f =&gt; 1)
 ‚ãÆ
 Dict(0xfd2b28b3f5f2b393 =&gt; 1, 0x741f0a7e4804043a =&gt; 1, 0xf24212015864febb =&gt; 1, 0xf88aef1b5c42e41f =&gt; 1, 0x9531daea6936b073 =&gt; 1, 0x73eb6390c84ee754 =&gt; 1, 0x054d3f6b36e26ecb =&gt; 1, 0x7c79f6451b0ec17a =&gt; 2, 0x479860b54cec66b8 =&gt; 1, 0x1a7869342e66f0af =&gt; 1‚Ä¶)
 Dict(0xf24212015864febb =&gt; 2, 0x44460958690ba8ff =&gt; 1, 0xaf9a1b168f41462e =&gt; 1, 0xb306f37041fddc32 =&gt; 1, 0xf88aef1b5c42e41f =&gt; 1, 0x9531daea6936b073 =&gt; 3, 0x19821b1b9d6a2618 =&gt; 1, 0x94103885ab5c2f18 =&gt; 1, 0x5d8aee81a9ed5bff =&gt; 1, 0x7c79f6451b0ec17a =&gt; 1‚Ä¶)
 Dict(0xf24212015864febb =&gt; 1, 0x435310b51e0488db =&gt; 1, 0x405c5afdcb4767d0 =&gt; 1, 0x03306848c88827bf =&gt; 1, 0x9531daea6936b073 =&gt; 3, 0x19821b1b9d6a2618 =&gt; 1, 0xdbdda5ce48b8d489 =&gt; 1, 0x04bb135a10a75c37 =&gt; 1, 0x2bbcce7fa0db5f79 =&gt; 1, 0x1e9a75af8e4d7de2 =&gt; 1‚Ä¶)
 Dict(0x9531daea6936b073 =&gt; 1, 0x5ec7f63a9eb295b8 =&gt; 1, 0x78757524339ddb1c =&gt; 1, 0x10a87038574b5cef =&gt; 1, 0x6d42661a05074e1d =&gt; 1)
 Dict(0xf24212015864febb =&gt; 1, 0x001d95b498eab514 =&gt; 1, 0xc81dc2ac4837ef97 =&gt; 1, 0x5a2ae96ac75fc776 =&gt; 1, 0x9531daea6936b073 =&gt; 2, 0xfb3c6d9b3b2e8b45 =&gt; 1, 0x7c79f6451b0ec17a =&gt; 1, 0x35fe8c5b4a2f0680 =&gt; 1, 0xc6b18e7e7ed2e033 =&gt; 1, 0x4d45112e43473c4f =&gt; 1‚Ä¶)
 Dict(0x6c4075bfad4b4a07 =&gt; 1, 0x405c5afdcb4767d0 =&gt; 1, 0x9531daea6936b073 =&gt; 1, 0xd92ea41ac567e00c =&gt; 1, 0x479860b54cec66b8 =&gt; 1, 0x1b871e706897c99c =&gt; 1)
 Dict(0xf24212015864febb =&gt; 1, 0x1a8e2c5070db2322 =&gt; 1, 0xa36b61cbc03e4f9a =&gt; 1, 0x9531daea6936b073 =&gt; 2, 0x02eb319735bca9ef =&gt; 1, 0xb545974aff4f5b3e =&gt; 1, 0xa1757b26a96f3d73 =&gt; 1, 0x5ffda4eb2022f089 =&gt; 1, 0xf3ff6e957c1b3128 =&gt; 1, 0x27fdf7410c0697fd =&gt; 1‚Ä¶)
 Dict(0xebd08dfa05d1523d =&gt; 1, 0x9531daea6936b073 =&gt; 1, 0xa88c1c077c66ed63 =&gt; 1, 0x861ec1c7f31db13b =&gt; 1, 0x4d45112e43473c4f =&gt; 1, 0xf26b4143a201e5c0 =&gt; 1, 0x3d98f6cdb49976d5 =&gt; 1)
 Dict(0xeebee57fa071401b =&gt; 1, 0x93017f16f1845e03 =&gt; 1, 0x9531daea6936b073 =&gt; 1, 0x3bdbf6858e455a91 =&gt; 1, 0x479860b54cec66b8 =&gt; 1, 0xa1431011cdc9bb9a =&gt; 1, 0xc449997d9a713ac1 =&gt; 1, 0x013b2d467f6471fb =&gt; 1, 0x4d45112e43473c4f =&gt; 1, 0x3d449ab259c7303b =&gt; 1‚Ä¶)

julia&gt; model = VectorModel(EntropyWeighting(), BinaryLocalWeighting(), vcorpus, labels)
{VectorModel global_weighting=EntropyWeighting(), local_weighting=BinaryLocalWeighting(), train-voc=44550, train-n=50000, maxfreq=94018}</code></pre><p>Now we can vectorize a text</p><pre><code class="language-julia-repl">julia&gt; vec = vectorize(tok, model, &quot;la mejor m√∫sica, la m√∫sica de siempre!&quot;; normalize=false)
Dict{UInt64, Float32} with 7 entries:
  0xfa5db0e80cd0ced3 =&gt; 0.0959525
  0x02eb319735bca9ef =&gt; 0.00165757
  0xc9357b653a6d99f8 =&gt; 0.0308471
  0x3bdbf6858e455a91 =&gt; 0.00327948
  0x10a87038574b5cef =&gt; 0.000889536
  0x81c92ba10d384d05 =&gt; 0.0239266
  0x03c1bab90bb0872a =&gt; 0.0231009

julia&gt; decode(tok, vec)
Dict{String, Float32} with 7 entries:
  &quot;de&quot;      =&gt; 0.000889536
  &quot;,&quot;       =&gt; 0.00327948
  &quot;musica&quot;  =&gt; 0.0959525
  &quot;!&quot;       =&gt; 0.0239266
  &quot;mejor&quot;   =&gt; 0.0308471
  &quot;siempre&quot; =&gt; 0.0231009
  &quot;la&quot;      =&gt; 0.00165757</code></pre><h1 id="Inspecting-models"><a class="docs-heading-anchor" href="#Inspecting-models">Inspecting models</a><a id="Inspecting-models-1"></a><a class="docs-heading-anchor-permalink" href="#Inspecting-models" title="Permalink"></a></h1><p>Models have a <code>id2token</code> dictionary to map identifiers to symbols</p><pre><code class="language-julia-repl">julia&gt; model.tokens
Dict{UInt64, TextSearch.TokenStats} with 44550 entries:
  0xe26d1b1f2f553177 =&gt; TokenStats(1, 1, 1.0)
  0x2a51a9cd0f17d04b =&gt; TokenStats(3, 3, 0.736893)
  0x112eeae3ea6df7a4 =&gt; TokenStats(1, 1, 1.0)
  0xae2b770f1a2cfc9b =&gt; TokenStats(3, 3, 0.736669)
  0xaf0eb90b3b1337d1 =&gt; TokenStats(1, 1, 1.0)
  0xbce85aa0ba0c8313 =&gt; TokenStats(1, 1, 1.0)
  0x8be0c9dcd9af4916 =&gt; TokenStats(1, 1, 1.0)
  0x72b25bff3d3b46b4 =&gt; TokenStats(1, 1, 1.0)
  0xa2b5bad82c30d26e =&gt; TokenStats(3, 3, 0.740381)
  0xffb9637a52d6ad16 =&gt; TokenStats(3, 3, 0.736808)
  0x9e4efeaa02f6d9dc =&gt; TokenStats(1, 1, 1.0)
  0x20ed2f2be7bcf27d =&gt; TokenStats(1, 1, 1.0)
  0x7bbc0905f48e70b1 =&gt; TokenStats(4, 4, 0.667597)
  0x6dcaf280635c04d2 =&gt; TokenStats(12, 12, 0.430697)
  0x632241edf4e9e265 =&gt; TokenStats(3, 3, 0.736042)
  0x5c39de02e03c347b =&gt; TokenStats(2, 2, 1.0)
  0xefeda4fcc355377a =&gt; TokenStats(18, 17, 0.375766)
  0x12031c55f76c77ba =&gt; TokenStats(1, 1, 1.0)
  0x0e3dc39e1a8b86ad =&gt; TokenStats(1, 1, 1.0)
  ‚ãÆ                  =&gt; ‚ãÆ</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../preprocessing/">¬´ Preprocessing</a><a class="docs-footer-nextpage" href="../api/">API ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 20 October 2021 14:50">Wednesday 20 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
